\documentclass[17pt]{extarticle} % another possible option: 20 pt
\usepackage{ifpdf}
\ifpdf
\usepackage{cmap}
\fi
\usepackage[english]{babel}
\usepackage{palatino}
\usepackage[x11names,svgnames]{xcolor}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{tikz}
\usepackage{amsthm}
\usepackage{pgf}
\usepackage{multicol}
\usepackage{xspace}
\usepackage{graphicx}
\usepackage{multicol}
\usepackage[section]{algorithm} % [section] is use to define the numbering mode
\usepackage{algorithmic} 
\usepackage[a1paper,left=2.5cm,right=.5cm,top=2.5cm,bottom=.5cm,foot=0cm]{geometry}
\usepackage{poster}
\usepackage{booktabs}
\usepackage{multirow,multicol}
\usepackage{simplewick}

\usetikzlibrary{positioning,fadings}

\usepackage{pgfplots}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{proposition}{Proposition}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{theorem}{Theorem}[section]
                             

\def\nodeshadowed[#1]#2;{
\node[scale=2,above,#1]{#2};
\node[scale=2,above,#1,yscale=-1,opacity=0.4]{#2};}

\def\myarc#1#2#3#4{
  \draw[color=#1,line width=2pt,->] (360*#2/18:#4mm) arc (360*#2/18:360*#3/18:#4mm);
}%#1 -- color, #2 -- from, #3 -- to, #4 -- radius (mm)

\def\ra{red}
\def\rb{green}
\def\rc{cyan}
\def\rd{magenta}
\def\re{blue}
\def\rf{orange}

\newcommand{\myignore}[1]{}

\begin{document}
\pagestyle{empty}

%%% RAMKA
%\noindent\hspace{-2cm}
%\begin{tikzpicture}[rounded corners=2cm,x=1cm,y=1cm]
%  \draw (0,-1) [color=SteelBlue3,line width=2mm] rectangle (55.5,79);
%\end{tikzpicture}
%\vspace{-78.5cm}

%%% TITLE
%\begin{center}
  %{\color{OrangeRed} \fontsize{48pt}{1em} {\bf Earmark graph approach to {\it de novo} genome assembly}}
  %\vspace{1.5cm}
    
  %\fontsize{32pt}{2.5em}\selectfont
  %\color{DodgerBlue3}
  %{\bf Mikhail Dvorkin, Alexander S. Kulikov, Max Alekseyev}
  %{affiliations}
  %{\tt emails}
%\end{center}%
%\vspace{1cm}

%\fontsize{32pt}{2.5em}\selectfont

\begin{center}
\begin{tikzpicture}

%%%%%%%%%%%%%%%GRID
%\draw[step=1cm,help lines] (0,0) grid (54,78);
%\foreach \x in {0,...,54} { \node at (\x,-1) {$\x$}; \node at (\x,79) {$\x$}; }
%\foreach \x in {0,...,78} { \node at (-1,\x) {$\x$}; \node at (55,\x) {$\x$}; }

%%%%%%%%%%%%%%%TITLE
\begin{scope}
\draw (0,78) [color=SteelBlue3,line width=2mm,rounded corners=.5cm,fill=blue!10!white] rectangle (54,70);
\node at (27,76) {\color{OrangeRed} \fontsize{60pt}{1em} \bf Earmark graph approach to de novo genome assembly};
\node[rectangle,text width=16cm,text centered,anchor=north west] at (1,74) {
  {\bf \color{DodgerBlue3} \fontsize{32pt}{1em}\selectfont Max Alekseyev}\\
  %Algorithmic Biology Lab, Academic University, RAS\\
  %{\tt http://bioinf.spbau.ru/members/mikhail-dvorkin/}
};
\node[rectangle,text width=16cm,text centered,anchor=north west] at (18,74) {
  {\bf \color{DodgerBlue3} \fontsize{32pt}{1em}\selectfont Mikhail E. Dvorkin}\\
  %Algorithmic Biology Lab, Academic University, RAS\\
  %{\tt http://bioinf.spbau.ru/members/mikhail-dvorkin/}
};
\node[rectangle,text width=16cm,text centered,anchor=north west] at (36,74) {
  {\bf \color{DodgerBlue3} \fontsize{32pt}{1em}\selectfont Alexander S. Kulikov}\\
  %Algorithmic Biology Lab, Academic University, RAS and\\
  %Steklov Mathematical Institute at St.~Petersburg, RAS\\
  %{\tt http://logic.pdmi.ras.ru/$\sim$kulikov/}
};
\node[rectangle,text width=52cm,text centered,anchor=north west] at (1,72.5) {
  \fontsize{26pt}{1em}\selectfont
  Algorithmic Biology Lab at St.~Petersburg Academic University of the 
  Russian Academy of Sciences\\
  {\tt http://bioinf.spbau.ru/en/}
\\
% We've got to include this:
\small{The presentation of this work was made possible by a Travel Fellowship awarded by ISCB
with grant funds obtained from the Department of Energy Office of Science,
the National Science Foundation Bio-Directorate,
and the NIH National Institute of General Medical Sciences.}
};

\end{scope}

%%%%%%%%%%%%%%%PROBLEM STATEMENT AND ABSTRACT
\begin{scope}
\draw ( 0,67) [color=SteelBlue3,line width=2mm,rounded corners=.5cm] rectangle (26,60);
\draw (28,67) [color=SteelBlue3,line width=2mm,rounded corners=.5cm] rectangle (54,60);
\node[draw=SteelBlue3,line width=2mm,rounded corners=.5cm,anchor=south west,fill=blue!10!white,inner sep=3mm] at (28,67) {\fontsize{32pt}{1em} 
\bf Typical genome assembly setting};
\node[draw=SteelBlue3,line width=2mm,rounded corners=.5cm,anchor=south west,fill=blue!10!white,inner sep=3mm] at (0,67) {\fontsize{32pt}{1em} 
\bf Abstract\phantom{y}};
\node[rectangle,anchor=north west,text width=25cm,inner sep=5mm] at (0,67) {
  A common approach to assembling a genome from short reads is constructing
  the de Bruijn graph on all $k$-mers from the given set of reads and finding
  a traversal of edges in this graph. We propose a new approach that allows
  to decrease the graph size without losing the essential information from
  the input data. Instead of using all the $k$-mers from a read we take only
  a few of them (and call them earmarked). Besides an obvious advantage
  of requiring less memory and time for constructing, the resulting earmark
  graph has several other advantages over the de Bruijn graph. We discuss
  them in the paper and also present some experimental results.
};
\node[rectangle,anchor=west,text width=25cm,inner sep=5mm] at (28,63.5) {
  \fontsize{26pt}{2em}\selectfont
  {\bf Input:} a set of substrings (called reads) 
    ${\cal R} \subseteq \{{\tt A,C,G,T}\}^r$ of an unknown circular string 
    $S \in \{{\tt A,C,G,T}\}^*$ (called genome).

  {\bf Output:} the genome $S$.

  {\bf Complications: } blah-blah-blah...
};
%at (27,64) {\fontsize{26pt}{1em} Given a set of reads ${\cal R} \subseteq \{{\tt 
%A,C,G,T}\}^r$ of a genome $S \in \{{\tt A,C,G,T}\}^*$, find the genome $S$.};
\end{scope}

%%%%%%%%%%%%%%%EXAMPLE
\begin{scope}[yshift=-5cm]
  \draw (0,62) [color=SteelBlue3,line width=2mm,rounded corners=.5cm] rectangle (54,35);
  \node[draw=SteelBlue3,line width=2mm,rounded corners=.5cm,anchor=south west,fill=blue!10!white,inner sep=3mm] at (0,62) {\fontsize{32pt}{1em} \bf 
    Standard and new approach: example};

  %%% READS
  \node[rectangle,line width=2pt,text width=5cm,text centered,anchor=west] (reads) at (1,48.5) {
    {\bf set ${\cal R}$ of $8$-reads}\\
    {\color{\ra}  $R_1$: {\tt CATGTAGT}}\\
    {\color{\rb}  $R_2$: {\tt GTAACATG}}\\
    {\color{\rc}  $R_3$: {\tt AGTGTACA}}\\
    {\color{\rd}  $R_4$: {\tt CATGTAGT}}\\
    {\color{\re}  $R_5$: {\tt CATGTAAC}}\\
    {\color{\rf}  $R_6$: {\tt TAACATGT}}\\
  };

  \begin{scope}[xshift=50.5cm,yshift=48.5cm]
    \node (genometop)  at (0,3.5) {};
    \node (genomedown) at (0,-3.5) {};

    \foreach \i/\a in {0/C,1/A,2/T,3/G,4/T,5/A,6/A,7/C,8/A,9/T,10/G,11/T,12/A,13/G,14/T,15/G,16/T,17/A} {
      \node[fill=white] at (360*\i/18:2cm) {{\tt \a}};
    }
    \node at (0,0) {genome $S$};
    %\draw[color=red,->] (360*5/18:2.2cm) arc (360*5/18:360*11/18:2.2cm);
    \myarc{black}{1}{18}{16}
    \myarc{\ra}{4}{11}{24}     %R1
    \myarc{\rb}{3}{10}{26}    %R2
    \myarc{\rc}{-5}{2}{28}    %R3
    \myarc{\rd}{-3}{4}{30}   %R4
    \myarc{\re}{1}{8}{32}   %R5
    \myarc{\rf}{3}{10}{34}  %R6
  \end{scope}

  %\draw [->,line width=2pt] (reads) to[out=90,in=180] node[sloped,fill=white] {de Bruijn graph} (23,53);
  %\draw [->,line width=2pt] (reads) to[out=-90,in=180] node[sloped,fill=white] {earmark graph} (23,44);


\myignore{
  \begin{scope}[scale=1.3,transform shape,line width=2pt]
    \begin{scope}[xshift=20cm,yshift=40cm]
      \foreach \x/\y/\t in {1.5/1/AAT, 2.5/2/ATG, 4/2/TGC, 4.5/3.5/GCA, 6/4/CAT, 
                            7.5/4.5/ATT, 9/4/TTG, 9/3/CAC, 10.5/2.5/ACT, 12/2/CTG,
                            13.5/1.5/CAA}
      \node[draw,rectangle,scale=0.7] (\t) at (\x,\y) {{\tt \t}};

      \foreach \s/\t in {AAT/ATG, ATG/TGC, TGC/GCA, GCA/CAT, CAT/ATT, ATT/TTG, TTG/TGC, 
                         GCA/CAC, CAC/ACT, ACT/CTG}
        \draw [->] (\s) to (\t);
      \draw [->] (GCA) to[bend left=70] (CAA);
      \draw [->] (CAA) to[bend left=20] (AAT);
      \draw [->] (CTG) to[bend left=20] (TGC);
      %\path[->] (GCA) edge [out=90,in=90] (CAA);
    \end{scope}

    \begin{scope}[xshift=20cm,yshift=29cm]
      \foreach \x/\y/\t in {1.5/1/AAT, 2.5/2/ATG, 6/4/CAT, 
                            7.5/4.5/ATT, 9/4/TTG, 9/3/CAC, 10.5/2.5/ACT, 12/2/CTG,
                            13.5/1.5/CAA}
      \node[draw,rectangle,scale=0.7] (\t) at (\x,\y) {{\tt \t}};

      \foreach \s/\t in {AAT/ATG, CAT/ATT, ATT/TTG, TTG/CAC, 
        CAC/ACT, ACT/CTG, CTG/CAA}
        \draw [->] (\s) to (\t);
      \draw [->] (CAA) to[bend left=20] (AAT);
      \draw [->] (ATG) to[bend left=50] (CAT);
    \end{scope}
  \end{scope}
}

  \node[anchor=south west,scale=0.5] (debruijngraph) at (30,51) {\includegraphics{de.pdf}};
  \node[anchor=south west,scale=0.5] (earmarkgraph)  at (30,37) {\includegraphics{en.pdf}};

  \node[rectangle,line width=2pt,text width=5cm,text centered,anchor=west] (earmarks) at (9,40) {
    {\bf earmarks}\\
    {\tt CATG} {\tt TACA}\\
    {\tt GTAA} {\tt ACAT}\\
    {\tt AGTG} {\tt TAGT}
  };

  \node[rectangle,line width=2pt,text width=5cm,text centered,anchor=west] (earmarkedreads) at (18,45) {
    {\color{\ra} $R_1: \contraction{}{\tt C}{\tt AT}{\tt G}%
    \contraction{\tt CATG}{\tt T}{\tt AG}{\tt T}%
    {\tt CATGTAGT}$ }

    {\color{\rb} $R_2: \contraction{}{\tt G}{\tt TA}{\tt A}%
    \contraction{\tt GTA}{\tt A}{\tt CA}{\tt T}%
    \bcontraction{\tt GTAA}{\tt C}{\tt AT}{\tt G}%
    {\tt GTAACATG}$ }

    {\dots}
  };

  \begin{scope}[draw=SteelBlue3,line width=3pt,fill=white]
    \draw [->] (reads) to[out=90,in=180] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 1. represent each $8$-read as a path on its $5$ consecutive $4$-mers} (debruijngraph);

    \draw [->] (debruijngraph) to[out=45,in=90] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 2. simplify the graph and find a cycle containing all the edges} (genometop);

    \draw [->] (reads) to[out=-90,in=180] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 1. construct a set ${\cal E} \subseteq \{{\tt A,C,G,T}\}^3$ of earmarked $3$-mers s.t. each read contains at least
      two earmarked $4$-mers} (earmarks);

    \draw [->] (earmarks) to[out=90,in=180] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 2. find the earmarks in the reads} (earmarkedreads);

    \draw [->] (earmarkedreads) to[out=0,in=180] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 3. represent each $8$-read as a path on its consecutive earmarks} (earmarkgraph);

    \draw [->] (earmarkgraph) to[out=-30,in=-90] node[fill=white,sloped,rectangle,text width=5cm] 
      {\color{DodgerBlue3} 4. simplify the graph and find a cycle containing all the edges} (genomedown);
  \end{scope}

  \node at (36,60) {\fontsize{26pt}{1em} \color{OrangeRed} \bf de Bruijn graph};
  \node at (36,36) {\fontsize{26pt}{1em} \color{OrangeRed} \bf earmark graph};
  \draw[color=OrangeRed,dashed,line width=5pt] (7,48) -- (46,48);
\end{scope}

%%%%%%%%%%%%%%%ADVANTAGES
\begin{scope}[yshift=-5cm]
  \draw (0,32) [color=SteelBlue3,line width=2mm,rounded corners=.5cm] rectangle (54,22);
  \node[draw=SteelBlue3,line width=2mm,rounded corners=.5cm,anchor=south west,fill=blue!10!white,inner sep=3mm] at (0,32) {\fontsize{32pt}{1em} \bf 
    Advantages of earmark graph over de Bruijn graph: to be rewritten};
  \node[rectangle,text width=51cm,anchor=north west] at (1,31) {
    \fontsize{24pt}{1em}\selectfont
    \begin{description}
    \item[\color{OrangeRed} \bf Smaller size.]
    The earmark graph requires less time and memory for construction.
    Note also that one can control the size of the earmark graph 
    by varying the size of the set of earmarks (e.g., by varying the value of the parameter $t$
    of Algorithm~\ref{alg:earmarksselection}).
    \item[\color{OrangeRed} \bf Some of short repeats are already resolved.]
    To give an example, consider two reads {\tt TTGCAC} and {\tt ATGCAT} 
    sharing a $4$-mer {\tt TGCA}. They are represented as two paths, shown 
    in Fig.~\ref{fig:repa}, in the de Bruijn graph built on $3$-mers
    (this is a part of the de Bruijn graph from Fig.~\ref{fig:debruijn}).
    This is a typical repeat. The edge ${\tt TGC}\rightarrow{\tt GCA}$ has two
    incoming edges and two outgoing edges. While spelling a genome
    through this part of the graph it is not clear which incoming edge 
    corresponds to which outgoing edge. However in the earmarked graph
    this repeat may be already resolved if the $3$-mers {\tt TGC} and {\tt GCA}
    are not earmarked, see Fig.~\ref{fig:repb}.
    \item[\color{OrangeRed} \bf Less errors.] Erroneous $k$-mers can be excluded from the graph already on
    the construction stage.
    \end{description}
  };
\end{scope}

%%%%%%%%%%%%%%%PRACTICAL RESULTS
\begin{scope}%[yshift=-4cm]
  \draw (0,19) [color=SteelBlue3,line width=2mm,rounded corners=.5cm] rectangle (54,0);
  \node[draw=SteelBlue3,line width=2mm,rounded corners=.5cm,anchor=south west,fill=blue!10!white,inner sep=3mm] at (0,19) {\fontsize{32pt}{1em} \bf 
    Practical results: to be rewritten};
  
  \begin{scope}[xshift=33cm,yshift=8cm,scale=1.5]
    \begin{axis}[xlabel={HTAKE},ylabel={$\#$ of vertices}]
    \addplot[smooth,mark=*,blue] plot coordinates { (1,1640) (2,2950) (3,4248) (4,5472) (5,6784)
      (10, 12028) (20, 15432) (25, 18642) (40, 19890) (50, 20052) (60, 20102) (75,20140) };
    %\addlegendentry{de Bruijn}
    \end{axis}
  \end{scope}

  \node[rectangle,text width=27cm,anchor=north west] at (1,17) {
    \input{../data/stat400k.tex}
  };
\end{scope}


\end{tikzpicture}
\end{center}


\end{document}
