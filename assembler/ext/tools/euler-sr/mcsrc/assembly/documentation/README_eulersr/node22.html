<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">

<!--Converted with LaTeX2HTML 2002 (1.67)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Detecting variation.</TITLE>
<META NAME="description" CONTENT="Detecting variation.">
<META NAME="keywords" CONTENT="README_eulersr">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="README_eulersr.css">

<LINK REL="next" HREF="node23.html">
<LINK REL="previous" HREF="node21.html">
<LINK REL="up" HREF="node21.html">
<LINK REL="next" HREF="node23.html">
</HEAD>

<BODY >
<!--Navigation Panel-->
<A NAME="tex2html335"
  HREF="node23.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html331"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html325"
  HREF="node21.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html333"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html336"
  HREF="node23.html">Fast pooling of reads.</A>
<B> Up:</B> <A NAME="tex2html332"
  HREF="node21.html">Nonstandard assemblies.</A>
<B> Previous:</B> <A NAME="tex2html326"
  HREF="node21.html">Nonstandard assemblies.</A>
 &nbsp <B>  <A NAME="tex2html334"
  HREF="node1.html">Contents</A></B> 
<BR>
<BR>
<!--End of Navigation Panel-->

<H3><A NAME="SECTION00044100000000000000">
Detecting variation.</A>
</H3>

<P>
To detect variants, not all the steps to run an assembly need to be
	performed.  Since variant detection is still being developed, you
	have to manually run most assembly steps, however a final
	post-processing tool exists that prints likely variants.

<P>
To detect variants using a file reads.fasta:
	1. Fix errors:
<PRE>
	
	${EUSRC}/assembly/FixErrors.pl reads.fasta 25
</PRE>

<P>
2. Build the de bruijn graph:

<P>
<PRE>
	${EUSRC}/assembly/assemblesec.pl reads.fasta.fixed -vertexSize 25
</PRE>

<P>
3. Remove some errors from the graph

<P>
<PRE>
	mkdir simple;
	${EUSRC}/assembly/${MACHTYPE}/simplifyGraph reads.fasta.fixed
	simple/reads.fasta -minEdgeLength 75 -removeLowCoverage 5 3
</PRE>

<P>
4. Run post-processing to detect variants.

<P>
<PRE>
	${EUSRC}/assembly/${MACHTYPE}/printVariants simple/reads.fasta
	reads.variants.fasta
</PRE>

<P>
This will produce a fasta file, reads.variants.fasta.  You can use
	the fasta titles to collect the variants.  The format is:

<P>
<PRE>
	&gt;SHARED\_EDGE INDEX (length, read support) VARIANT\_INDEX (length,
   support) [... VARIANT\_INDEX2 (length2, support2)] SHARED\_EDGE2(length,support)
</PRE>

<P>
This outputs a variant and the flanking sequences so that the variant
may be easily aligned to a reference.  The numbers in the FASTA titles
are: EDGE_INDEX(LENGTH,SUPPORT), where EDGE_INDEX is the index of the
edge in the ".edge" file (the same as a contig, but edges exist for
both the forward and reverse orientation), the length of the edge (the
middle lengths represent the lengths of the variants), and finally the
support, the number of reads used to build the edge in the assembly.
Very low support indicates that the variant is probably erroneous.  In
the example below, there is an indel of length 6 in the assembly.  The
alignment below is the bl2seq alignment of the two variants.

<P>
<PRE>
&gt;0(1855, 2957) 21(49, 44) 8(2274, 3692) 
AGAAAGGGATTTTAGTTTGTAATATCGCAGCAAGTCGATTGATTTTACCGTCTCCCAATGCATTCAAAGATAGTATTGTAAAAATCTCAGTTGGTGAAGAATATGATCAACACGCGTTTATCCATCAGTTAAAGGAAAATGGCTATCGAAAAGTTACTCAAGTACAAACTCAGGGCGAATTTAGTCTTCGAGGAGATATTATTTTTGAAATATCCCAGTTAGAACCTTGTCGAATTGAGTTTTTTGGTGATGAAATTGATGGTATCAGGTCATTTGAAGTAGAAACACAATTATCGAAAGAAAATAAGACAGAACTCACTATCTTTCCAGCTAGTGATATGCTTTTGAGAGAAAAGGATTATCAACGAGGACAGTCAGCTTTAGAAAAACAAATTTCAA
&gt;0(1855, 2957) 22(55, 39) 8(2274, 3692) 
AGAAAGGGATTTTAGTTTGTAATATCGCAGCAAGTCGATTGATTTTACCGTCTCCCAATGCATTCAAAGATAGTATTGTAAAAATCTCAGTTGGTGAAGAATATGATCAACACGCGTTTATCCATCAGTTAAAGGAAAATGGCTATCGAAAAGTTACTCAAGTACAAACTCAGGGCGAATTTAGTCTTCGAGGAGATATTTTAGATATTTTTGAAATATCCCAGTTAGAACCTTGTCGAATTGAGTTTTTTGGTGATGAAATTGATGGTATCAGGTCATTTGAAGTAGAAACACAATTATCGAAAGAAAATAAGACAGAACTCACTATCTTTCCAGCTAGTGATATGCTTTTGAGAGAAAAGGATTATCAACGAGGACAGTCAGCTTTAGAAAAACAAATTTCAA

Query  1    AGAAAGGGATTTTAGTTTGTAATATCGCAGCAAGTCGATTGATTTTACCGTCTCCCAATG  60
            ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  1    AGAAAGGGATTTTAGTTTGTAATATCGCAGCAAGTCGATTGATTTTACCGTCTCCCAATG  60

Query  61   CATTCAAAGATAGTATTGTAAAAATCTCAGTTGGTGAAGAATATGATCAACACGCGTTTA  120
            ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  61   CATTCAAAGATAGTATTGTAAAAATCTCAGTTGGTGAAGAATATGATCAACACGCGTTTA  120

Query  121  TCCATCAGTTAAAGGAAAATGGCTATCGAAAAGTTACTCAAGTACAAACTCAGGGCGAAT  180
            ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  121  TCCATCAGTTAAAGGAAAATGGCTATCGAAAAGTTACTCAAGTACAAACTCAGGGCGAAT  180

Query  181  TTAGTCTTCGAGGAGATAT------TATTTTTGAAATATCCCAGTTAGAACCTTGTCGAA  234
            |||||||||||||||||||      |||||||||||||||||||||||||||||||||||
Sbjct  181  TTAGTCTTCGAGGAGATATTTTAGATATTTTTGAAATATCCCAGTTAGAACCTTGTCGAA  240

Query  235  TTGAGTTTTTTGGTGATGAAATTGATGGTATCAGGTCATTTGAAGTAGAAACACAATTAT  294
            ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  241  TTGAGTTTTTTGGTGATGAAATTGATGGTATCAGGTCATTTGAAGTAGAAACACAATTAT  300

Query  295  CGAAAGAAAATAAGACAGAACTCACTATCTTTCCAGCTAGTGATATGCTTTTGAGAGAAA  354
            ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct  301  CGAAAGAAAATAAGACAGAACTCACTATCTTTCCAGCTAGTGATATGCTTTTGAGAGAAA  360

Query  355  AGGATTATCAACGAGGACAGTCAGCTTTAGAAAAACAAATTTCAA  399
            |||||||||||||||||||||||||||||||||||||||||||||
Sbjct  361  AGGATTATCAACGAGGACAGTCAGCTTTAGAAAAACAAATTTCAA  405
</PRE>

<P>
<HR>
<!--Navigation Panel-->
<A NAME="tex2html335"
  HREF="node23.html">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next"
 SRC="file:/usr/local/share/lib/latex2html/icons/next.png"></A> 
<A NAME="tex2html331"
  HREF="node21.html">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up"
 SRC="file:/usr/local/share/lib/latex2html/icons/up.png"></A> 
<A NAME="tex2html325"
  HREF="node21.html">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous"
 SRC="file:/usr/local/share/lib/latex2html/icons/prev.png"></A> 
<A NAME="tex2html333"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents"
 SRC="file:/usr/local/share/lib/latex2html/icons/contents.png"></A>  
<BR>
<B> Next:</B> <A NAME="tex2html336"
  HREF="node23.html">Fast pooling of reads.</A>
<B> Up:</B> <A NAME="tex2html332"
  HREF="node21.html">Nonstandard assemblies.</A>
<B> Previous:</B> <A NAME="tex2html326"
  HREF="node21.html">Nonstandard assemblies.</A>
 &nbsp <B>  <A NAME="tex2html334"
  HREF="node1.html">Contents</A></B> 
<!--End of Navigation Panel-->
<ADDRESS>
Mark Chaisson
2008-12-14
</ADDRESS>
</BODY>
</HTML>
