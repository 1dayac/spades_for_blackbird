#!/bin/bash

function run_n_measure
{
   if [ "$(uname -s)" == "Darwin" ]; then # Mac OS X
       /usr/bin/time $1 $2 $3 $4 $5 $6 $7
   else # other, e.g. Linux
       /usr/bin/time -f "\n\ntime: %E" $1 $2 $3 $4 $5 $6 $7
   fi
}

function run_dataset
{

    awk '/\{/ {print str} {str = $1}' configs/debruijn/datasets.info > temp

    dataset="`grep $1 temp`"
    if [ ` echo "$dataset" | sed -n '$='` == 1 ]; then
        echo "$dataset dataset chosen"
        awk -v ds=$dataset '{if ($1 == "dataset") print "dataset","\t",ds; else print $0}' configs/debruijn/config.info  > config.info
        mv config.info configs/debruijn/config.info
    else
        echo "Dataset ambiguos :"
        echo "$dataset"
    fi

    rm temp
}

if [ $# = 0 ]
then
    run_n_measure build/release/debruijn/debruijn configs/debruijn/config.info 
else 
case $1 in

'dd' ) run_n_measure build/debug/debruijn/debruijn configs/debruijn/config.info ;;
'ddt' ) run_n_measure build/debug/test/debruijn/debruijn_test ;;
'rdt' ) run_n_measure build/release/test/debruijn/debruijn_test ;;
'dit' ) run_n_measure build/debug/test/include_test/include_test ;;
'dt') run_n_measure build/debug/test/debruijn/debruijn_test && run_n_measure build/debug/test/include_test/include_test ;;

* ) run_n_measure $1 $2 $3 $4 $5

esac
fi


