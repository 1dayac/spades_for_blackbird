#!/bin/bash
# go to the directory where you want to create subdirectory hammer
#
# run
# ../blah/../src/tools/dataset hammer nikolenko/full/path/
# or
# ../blah/../src/tools/dataset hammer nikolenko/full/path/file-prefix
cmd=$1
base=$0
shift

if [ "$cmd" == "hammer" ] ; then
    if [ -d hammer ] ; then
	echo PLEASE REMOVE DIRECTORY hammer
	exit
    fi
    files="$1*left.corrected* $1*right.corrected* $1*left.unpaired* $1*right.unpaired*"
    mkdir hammer
    echo copying $files ...
    cp $files hammer/
    cd hammer
    ls | xargs -I {} mv {} {}.fastq
    echo gzipping * ...
    gzip -9 *
    files="*left.corrected*gz *right.corrected*gz *left.unpaired*gz *right.unpaired*gz"
    cd ..
    $base generic $files
    exit
fi

if [ "$cmd" == "generic" ] ; then
    $base print TODO_NAME TODO TODO TODO N/A TODO $*
    exit
fi

if [ "$cmd" == "print" ] ; then
dataset=$1
shift
rl=$1
shift
is=$1
shift
ss=$1
shift
rg=$1
shift
len=$1
shift
f=$1
shift
s=$1
shift
sf=$1
shift
ss=$1

p="`pwd`"
f=`find $p -name $f`
f=${f//*input\//}
s=`find $p -name $s`
s=${s//*input\//}
sf=`find $p -name $sf 2> /dev/null`
sf=${sf//*input\//}
ss=`find $p -name $ss 2> /dev/null`
ss=${ss//*input\//}

echo $dataset
echo "{"
echo "	first	$f"
echo "	second	$s"
if [ "$sf" != "" ] ; then
    echo "	single_first	$sf"
fi
if [ "$ss" != "" ] ; then
    echo "	single_second	$ss"
fi
echo "	RL	$rl"
echo "	IS	$is"
echo "	single_cell	$ss"
echo "	reference_genome	$rg"
echo "	LEN	$len"
echo "}"
fi
